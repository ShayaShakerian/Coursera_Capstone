{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Arcaduim Project "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### This data set contains transactions occurring in an online store (E-commerce). \n",
    "\n",
    "Out of the 12,330 customer samples in the dataset, 84.5% (10,422) were negative class samples (i.e. customers who did not end up buying the product), and the rest (1908) were positive class samples (i.e. customers who ended up buying). \n",
    "\n",
    "\n",
    "#### The dataset consists of 10 numerical and 8 categorical attributes. \n",
    "\n",
    "<b>Revenue:</b> The 'Revenue' attribute can be used as the class label.\n",
    "\n",
    "<b>\"Administrative\"</b>, \"Administrative Duration\", \"Informational\", \"Informational Duration\", \"Product Related\" and \"Product Related Duration\": \n",
    "\n",
    "These represent the number of different types of pages visited by the visitor in that session and total time spent in each of these page categories. The values of these features are derived from the URL information of the pages visited by the user and updated in real time when a user takes an action, e.g. moving from one page to another. \n",
    "\n",
    "The \"Bounce Rate\", \"Exit Rate\" and \"Page Value\" features represent the metrics measured by \"Google Analytics\" for each page in the e-commerce site. \n",
    "    \n",
    "Bounce Rate: The value of \"Bounce Rate\" feature for a web page refers to the percentage of visitors who enter the site from that page and then leave (\"bounce\") without triggering any other requests to the analytics server during that session. \n",
    "    \n",
    "Exit Rate: The value of \"Exit Rate\" feature for a specific web page is calculated as for all pageviews to the page, the percentage that were the last in the session. \n",
    "\n",
    "Page Value: The \"Page Value\" feature represents the average value for a web page that a user visited before completing an e-commerce transaction. \n",
    "\n",
    "Special Day: The \"Special Day\" feature indicates the closeness of the site visiting time to a specific special day (e.g. Mother’s Day, Valentine's Day) in which the sessions are more likely to be finalized with transaction.\n",
    "\n",
    "The value of this attribute is determined by considering the dynamics of e-commerce such as the duration between the order date and delivery date. \n",
    "\n",
    "For example, for Valentina’s day, this value takes a nonzero value between February 2 and February 12, zero before and after this date unless it is close to another special day, and its maximum value of 1 on February 8. \n",
    "\n",
    "The dataset also includes operating system, browser, region, traffic type, visitor type as returning or new visitor, a Boolean value indicating whether the date of the visit is weekend, and month of the year.\n",
    "\n",
    "\n",
    "\n",
    "<b>Task:</b>\n",
    "\n",
    "Build a machine learning model to predict whether a customer will buy a product or not.\n",
    "\n",
    " "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Column Descriptions:\n",
    "\n",
    "Administrative: This is the number of pages of this type (administrative) that the user visited.\n",
    "\n",
    "Administrative_Duration: This is the amount of time spent in this category of pages.\n",
    "\n",
    "Informational: This is the number of pages of this type (informational) that the user visited.\n",
    "\n",
    "Informational_Duration: This is the amount of time spent in this category of pages.\n",
    "\n",
    "ProductRelated: This is the number of pages of this type (product related) that the user visited.\n",
    "\n",
    "ProductRelated_Duration: This is the amount of time spent in this category of pages.\n",
    "\n",
    "BounceRates: The percentage of visitors who enter the website through that page and exit without triggering any additional tasks.\n",
    "\n",
    "ExitRates: The percentage of pageviews on the website that end at that specific page.\n",
    "\n",
    "PageValues: The average value of the page averaged over the value of the target page and/or the completion of an eCommerce transaction.\n",
    "More information about how this is calculated\n",
    "\n",
    "SpecialDay: This value represents the closeness of the browsing date to special days or holidays (eg Mother's Day or Valentine's day) in which the transaction is more likely to be finalized. More information about how this value is calculated below.\n",
    "\n",
    "Month: Contains the month the pageview occurred, in string form.\n",
    "\n",
    "OperatingSystems: An integer value representing the operating system that the user was on when viewing the page.\n",
    "\n",
    "Browser: An integer value representing the browser that the user was using to view the page.\n",
    "\n",
    "Region: An integer value representing which region the user is located in.\n",
    "\n",
    "TrafficType: An integer value representing what type of traffic the user is categorized into.\n",
    "Read more about traffic types here.\n",
    "\n",
    "VisitorType: A string representing whether a visitor is New Visitor, Returning Visitor, or Other.\n",
    "\n",
    "Weekend: A boolean representing whether the session is on a weekend.\n",
    "\n",
    "Revenue: A boolean representing whether or not the user completed the purchase."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 207,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: termcolor in ./Documents/anaconda3/lib/python3.8/site-packages (1.1.0)\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install termcolor\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 210,
   "metadata": {},
   "outputs": [],
   "source": [
    "#load required libraries\n",
    "\n",
    "import itertools\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib.ticker import NullFormatter\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.ticker as ticker\n",
    "from sklearn import preprocessing\n",
    "\n",
    "from termcolor import colored\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Administrative</th>\n",
       "      <th>Administrative_Duration</th>\n",
       "      <th>Informational</th>\n",
       "      <th>Informational_Duration</th>\n",
       "      <th>ProductRelated</th>\n",
       "      <th>ProductRelated_Duration</th>\n",
       "      <th>BounceRates</th>\n",
       "      <th>ExitRates</th>\n",
       "      <th>PageValues</th>\n",
       "      <th>SpecialDay</th>\n",
       "      <th>Month</th>\n",
       "      <th>OperatingSystems</th>\n",
       "      <th>Browser</th>\n",
       "      <th>Region</th>\n",
       "      <th>TrafficType</th>\n",
       "      <th>VisitorType</th>\n",
       "      <th>Weekend</th>\n",
       "      <th>Revenue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Returning_Visitor</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>64.000000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.10</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Returning_Visitor</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>Returning_Visitor</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>2.666667</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>Returning_Visitor</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10</td>\n",
       "      <td>627.500000</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>Returning_Visitor</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Administrative  Administrative_Duration  Informational  \\\n",
       "0               0                      0.0              0   \n",
       "1               0                      0.0              0   \n",
       "2               0                      0.0              0   \n",
       "3               0                      0.0              0   \n",
       "4               0                      0.0              0   \n",
       "\n",
       "   Informational_Duration  ProductRelated  ProductRelated_Duration  \\\n",
       "0                     0.0               1                 0.000000   \n",
       "1                     0.0               2                64.000000   \n",
       "2                     0.0               1                 0.000000   \n",
       "3                     0.0               2                 2.666667   \n",
       "4                     0.0              10               627.500000   \n",
       "\n",
       "   BounceRates  ExitRates  PageValues  SpecialDay Month  OperatingSystems  \\\n",
       "0         0.20       0.20         0.0         0.0   Feb                 1   \n",
       "1         0.00       0.10         0.0         0.0   Feb                 2   \n",
       "2         0.20       0.20         0.0         0.0   Feb                 4   \n",
       "3         0.05       0.14         0.0         0.0   Feb                 3   \n",
       "4         0.02       0.05         0.0         0.0   Feb                 3   \n",
       "\n",
       "   Browser  Region  TrafficType        VisitorType  Weekend  Revenue  \n",
       "0        1       1            1  Returning_Visitor    False    False  \n",
       "1        2       1            2  Returning_Visitor    False    False  \n",
       "2        1       9            3  Returning_Visitor    False    False  \n",
       "3        2       2            4  Returning_Visitor    False    False  \n",
       "4        3       1            4  Returning_Visitor     True    False  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv(\"/Users/shaya/Desktop/Arcadium-Project/online_shoppers_intention.csv\")\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "705"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['ProductRelated'].max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 12330 entries, 0 to 12329\n",
      "Data columns (total 18 columns):\n",
      " #   Column                   Non-Null Count  Dtype  \n",
      "---  ------                   --------------  -----  \n",
      " 0   Administrative           12330 non-null  int64  \n",
      " 1   Administrative_Duration  12330 non-null  float64\n",
      " 2   Informational            12330 non-null  int64  \n",
      " 3   Informational_Duration   12330 non-null  float64\n",
      " 4   ProductRelated           12330 non-null  int64  \n",
      " 5   ProductRelated_Duration  12330 non-null  float64\n",
      " 6   BounceRates              12330 non-null  float64\n",
      " 7   ExitRates                12330 non-null  float64\n",
      " 8   PageValues               12330 non-null  float64\n",
      " 9   SpecialDay               12330 non-null  float64\n",
      " 10  Month                    12330 non-null  object \n",
      " 11  OperatingSystems         12330 non-null  int64  \n",
      " 12  Browser                  12330 non-null  int64  \n",
      " 13  Region                   12330 non-null  int64  \n",
      " 14  TrafficType              12330 non-null  int64  \n",
      " 15  VisitorType              12330 non-null  object \n",
      " 16  Weekend                  12330 non-null  bool   \n",
      " 17  Revenue                  12330 non-null  bool   \n",
      "dtypes: bool(2), float64(7), int64(7), object(2)\n",
      "memory usage: 1.5+ MB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<b>Observation</b>: \n",
    "\n",
    "1. There is no Null data\n",
    "\n",
    "2. Data Type for columns \"Month\" and \"VisitorType\" is object \n",
    "\n",
    "3. Data Type for columns \"Weekend\" and \"Revenue\" is bool\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 218,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1m\u001b[34mThe number of null values in each column is\u001b[0m\n",
      "\n",
      "Administrative             0\n",
      "Administrative_Duration    0\n",
      "Informational              0\n",
      "Informational_Duration     0\n",
      "ProductRelated             0\n",
      "ProductRelated_Duration    0\n",
      "BounceRates                0\n",
      "ExitRates                  0\n",
      "PageValues                 0\n",
      "SpecialDay                 0\n",
      "Month                      0\n",
      "OperatingSystems           0\n",
      "Browser                    0\n",
      "Region                     0\n",
      "TrafficType                0\n",
      "VisitorType                0\n",
      "Weekend                    0\n",
      "Revenue                    0\n",
      "dtype: int64\n",
      "\n",
      "\n",
      "\u001b[1m\u001b[31mThe total number of null values in dataset is \u001b[0m 0\n"
     ]
    }
   ],
   "source": [
    "# Check for total number of null values in dataset\n",
    "\n",
    "colored('Hello', 'green', attrs=['bold'])\n",
    "\n",
    "num_null_data = df.isnull().sum()\n",
    "\n",
    "print(colored(\"The number of null values in each column is\", \"blue\", attrs=['bold'] ))\n",
    "print(\"\")\n",
    "print(num_null_data)\n",
    "\n",
    "\n",
    "print(\"\")\n",
    "print(\"\")\n",
    "print(colored(\"The total number of null values in dataset is \", \"red\", attrs=['bold']),  num_null_data.sum())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## exploring columns \"Month\" "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# data = pd.get_dummies(data=df, columns=[\"Weekend\", \"VisitorType\"])\n",
    "\n",
    "# data.head(40)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Month={'Feb':2, 'Mar':3, 'May':5, 'Oct':10, 'June':6, 'Jul':7, 'Aug':8, 'Nov':11, 'Sep':9,'Dec':12}\n",
    "# df['Month']=df['Month'].map(Month)\n",
    "\n",
    "# VisitorType={'Returning_Visitor':3, 'New_Visitor':2, 'Other':1}\n",
    "# df['VisitorType']=df['VisitorType'].map(VisitorType)\n",
    "# d={True:1,False:0}\n",
    "# df['Weekend']=df['Weekend'].map(d)\n",
    "# df['Revenue']=df['Revenue'].map(d)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['Weekend']=df['Weekend'].apply(lambda x: 0 if x == False else 1 )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['Revenue']=df['Revenue'].apply(lambda x: 0 if x == False else 1 )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "VisitorType={'Returning_Visitor':3, 'New_Visitor':2, 'Other':1}\n",
    "\n",
    "df['VisitorType'] = df['VisitorType'].map(VisitorType)  #apply(lambda x: 0 if x == 'Other' 1 elif x = 'New_Visitor' else 2 )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Administrative</th>\n",
       "      <th>Administrative_Duration</th>\n",
       "      <th>Informational</th>\n",
       "      <th>Informational_Duration</th>\n",
       "      <th>ProductRelated</th>\n",
       "      <th>ProductRelated_Duration</th>\n",
       "      <th>BounceRates</th>\n",
       "      <th>ExitRates</th>\n",
       "      <th>PageValues</th>\n",
       "      <th>SpecialDay</th>\n",
       "      <th>Month</th>\n",
       "      <th>OperatingSystems</th>\n",
       "      <th>Browser</th>\n",
       "      <th>Region</th>\n",
       "      <th>TrafficType</th>\n",
       "      <th>VisitorType</th>\n",
       "      <th>Weekend</th>\n",
       "      <th>Revenue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>64.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>2.666667</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.140000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10</td>\n",
       "      <td>627.500000</td>\n",
       "      <td>0.020000</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>179</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6</td>\n",
       "      <td>163.250000</td>\n",
       "      <td>0.033333</td>\n",
       "      <td>0.033333</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.6</td>\n",
       "      <td>Feb</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>180</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>17</td>\n",
       "      <td>284.250000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.011765</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>181</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.6</td>\n",
       "      <td>Feb</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>182</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Feb</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8</td>\n",
       "      <td>260.000000</td>\n",
       "      <td>0.008333</td>\n",
       "      <td>0.025000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.8</td>\n",
       "      <td>Feb</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>184 rows × 18 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Administrative  Administrative_Duration  Informational  \\\n",
       "0                 0                      0.0              0   \n",
       "1                 0                      0.0              0   \n",
       "2                 0                      0.0              0   \n",
       "3                 0                      0.0              0   \n",
       "4                 0                      0.0              0   \n",
       "..              ...                      ...            ...   \n",
       "179               0                      0.0              0   \n",
       "180               0                      0.0              0   \n",
       "181               0                      0.0              0   \n",
       "182               0                      0.0              0   \n",
       "183               0                      0.0              0   \n",
       "\n",
       "     Informational_Duration  ProductRelated  ProductRelated_Duration  \\\n",
       "0                       0.0               1                 0.000000   \n",
       "1                       0.0               2                64.000000   \n",
       "2                       0.0               1                 0.000000   \n",
       "3                       0.0               2                 2.666667   \n",
       "4                       0.0              10               627.500000   \n",
       "..                      ...             ...                      ...   \n",
       "179                     0.0               6               163.250000   \n",
       "180                     0.0              17               284.250000   \n",
       "181                     0.0               1                 0.000000   \n",
       "182                     0.0               1                 0.000000   \n",
       "183                     0.0               8               260.000000   \n",
       "\n",
       "     BounceRates  ExitRates  PageValues  SpecialDay Month  OperatingSystems  \\\n",
       "0       0.200000   0.200000         0.0         0.0   Feb                 1   \n",
       "1       0.000000   0.100000         0.0         0.0   Feb                 2   \n",
       "2       0.200000   0.200000         0.0         0.0   Feb                 4   \n",
       "3       0.050000   0.140000         0.0         0.0   Feb                 3   \n",
       "4       0.020000   0.050000         0.0         0.0   Feb                 3   \n",
       "..           ...        ...         ...         ...   ...               ...   \n",
       "179     0.033333   0.033333         0.0         0.6   Feb                 1   \n",
       "180     0.000000   0.011765         0.0         0.0   Feb                 3   \n",
       "181     0.200000   0.200000         0.0         0.6   Feb                 4   \n",
       "182     0.200000   0.200000         0.0         0.0   Feb                 2   \n",
       "183     0.008333   0.025000         0.0         0.8   Feb                 3   \n",
       "\n",
       "     Browser  Region  TrafficType  VisitorType  Weekend  Revenue  \n",
       "0          1       1            1            3        0        0  \n",
       "1          2       1            2            3        0        0  \n",
       "2          1       9            3            3        0        0  \n",
       "3          2       2            4            3        0        0  \n",
       "4          3       1            4            3        1        0  \n",
       "..       ...     ...          ...          ...      ...      ...  \n",
       "179        1       6            2            3        0        0  \n",
       "180        2       6            2            3        1        0  \n",
       "181        2       1            3            3        0        0  \n",
       "182        4       1            1            3        0        0  \n",
       "183        2       1            3            3        1        0  \n",
       "\n",
       "[184 rows x 18 columns]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[df[\"Month\"] == \"Feb\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "# get all unique data in each columns before do the following (show that why you choose this changes)\n",
    "\n",
    "\n",
    "cleanup_nums = {\"Month\": {'Feb':2, 'Mar':3, 'May':5, 'Oct':10, 'June':6, 'Jul':7, 'Aug':8, 'Nov':11, 'Sep':9, 'Dec':12},\n",
    "                \"Revenue\": {True:1,False:0},\n",
    "                 \"Weekend\": {True:1,False:0}     }"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df.replace(cleanup_nums)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Administrative</th>\n",
       "      <th>Administrative_Duration</th>\n",
       "      <th>Informational</th>\n",
       "      <th>Informational_Duration</th>\n",
       "      <th>ProductRelated</th>\n",
       "      <th>ProductRelated_Duration</th>\n",
       "      <th>BounceRates</th>\n",
       "      <th>ExitRates</th>\n",
       "      <th>PageValues</th>\n",
       "      <th>SpecialDay</th>\n",
       "      <th>Month</th>\n",
       "      <th>OperatingSystems</th>\n",
       "      <th>Browser</th>\n",
       "      <th>Region</th>\n",
       "      <th>TrafficType</th>\n",
       "      <th>VisitorType</th>\n",
       "      <th>Weekend</th>\n",
       "      <th>Revenue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>64.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>2.666667</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.140000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10</td>\n",
       "      <td>627.500000</td>\n",
       "      <td>0.020000</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12325</th>\n",
       "      <td>3</td>\n",
       "      <td>145.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>53</td>\n",
       "      <td>1783.791667</td>\n",
       "      <td>0.007143</td>\n",
       "      <td>0.029031</td>\n",
       "      <td>12.241717</td>\n",
       "      <td>0.0</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12326</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5</td>\n",
       "      <td>465.750000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.021333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12327</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6</td>\n",
       "      <td>184.250000</td>\n",
       "      <td>0.083333</td>\n",
       "      <td>0.086667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>13</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12328</th>\n",
       "      <td>4</td>\n",
       "      <td>75.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>15</td>\n",
       "      <td>346.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.021053</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12329</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3</td>\n",
       "      <td>21.250000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.066667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12330 rows × 18 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Administrative  Administrative_Duration  Informational  \\\n",
       "0                   0                      0.0              0   \n",
       "1                   0                      0.0              0   \n",
       "2                   0                      0.0              0   \n",
       "3                   0                      0.0              0   \n",
       "4                   0                      0.0              0   \n",
       "...               ...                      ...            ...   \n",
       "12325               3                    145.0              0   \n",
       "12326               0                      0.0              0   \n",
       "12327               0                      0.0              0   \n",
       "12328               4                     75.0              0   \n",
       "12329               0                      0.0              0   \n",
       "\n",
       "       Informational_Duration  ProductRelated  ProductRelated_Duration  \\\n",
       "0                         0.0               1                 0.000000   \n",
       "1                         0.0               2                64.000000   \n",
       "2                         0.0               1                 0.000000   \n",
       "3                         0.0               2                 2.666667   \n",
       "4                         0.0              10               627.500000   \n",
       "...                       ...             ...                      ...   \n",
       "12325                     0.0              53              1783.791667   \n",
       "12326                     0.0               5               465.750000   \n",
       "12327                     0.0               6               184.250000   \n",
       "12328                     0.0              15               346.000000   \n",
       "12329                     0.0               3                21.250000   \n",
       "\n",
       "       BounceRates  ExitRates  PageValues  SpecialDay  Month  \\\n",
       "0         0.200000   0.200000    0.000000         0.0      2   \n",
       "1         0.000000   0.100000    0.000000         0.0      2   \n",
       "2         0.200000   0.200000    0.000000         0.0      2   \n",
       "3         0.050000   0.140000    0.000000         0.0      2   \n",
       "4         0.020000   0.050000    0.000000         0.0      2   \n",
       "...            ...        ...         ...         ...    ...   \n",
       "12325     0.007143   0.029031   12.241717         0.0     12   \n",
       "12326     0.000000   0.021333    0.000000         0.0     11   \n",
       "12327     0.083333   0.086667    0.000000         0.0     11   \n",
       "12328     0.000000   0.021053    0.000000         0.0     11   \n",
       "12329     0.000000   0.066667    0.000000         0.0     11   \n",
       "\n",
       "       OperatingSystems  Browser  Region  TrafficType  VisitorType  Weekend  \\\n",
       "0                     1        1       1            1            3        0   \n",
       "1                     2        2       1            2            3        0   \n",
       "2                     4        1       9            3            3        0   \n",
       "3                     3        2       2            4            3        0   \n",
       "4                     3        3       1            4            3        1   \n",
       "...                 ...      ...     ...          ...          ...      ...   \n",
       "12325                 4        6       1            1            3        1   \n",
       "12326                 3        2       1            8            3        1   \n",
       "12327                 3        2       1           13            3        1   \n",
       "12328                 2        2       3           11            3        0   \n",
       "12329                 3        2       1            2            2        1   \n",
       "\n",
       "       Revenue  \n",
       "0            0  \n",
       "1            0  \n",
       "2            0  \n",
       "3            0  \n",
       "4            0  \n",
       "...        ...  \n",
       "12325        0  \n",
       "12326        0  \n",
       "12327        0  \n",
       "12328        0  \n",
       "12329        0  \n",
       "\n",
       "[12330 rows x 18 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Administrative               int64\n",
       "Administrative_Duration    float64\n",
       "Informational                int64\n",
       "Informational_Duration     float64\n",
       "ProductRelated               int64\n",
       "ProductRelated_Duration    float64\n",
       "BounceRates                float64\n",
       "ExitRates                  float64\n",
       "PageValues                 float64\n",
       "SpecialDay                 float64\n",
       "Month                        int64\n",
       "OperatingSystems             int64\n",
       "Browser                      int64\n",
       "Region                       int64\n",
       "TrafficType                  int64\n",
       "VisitorType                  int64\n",
       "Weekend                      int64\n",
       "Revenue                      int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Administrative</th>\n",
       "      <th>Administrative_Duration</th>\n",
       "      <th>Informational</th>\n",
       "      <th>Informational_Duration</th>\n",
       "      <th>ProductRelated</th>\n",
       "      <th>ProductRelated_Duration</th>\n",
       "      <th>BounceRates</th>\n",
       "      <th>ExitRates</th>\n",
       "      <th>PageValues</th>\n",
       "      <th>SpecialDay</th>\n",
       "      <th>Month</th>\n",
       "      <th>OperatingSystems</th>\n",
       "      <th>Browser</th>\n",
       "      <th>Region</th>\n",
       "      <th>TrafficType</th>\n",
       "      <th>VisitorType</th>\n",
       "      <th>Weekend</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>64.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>2.666667</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.140000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10</td>\n",
       "      <td>627.500000</td>\n",
       "      <td>0.020000</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12325</th>\n",
       "      <td>3</td>\n",
       "      <td>145.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>53</td>\n",
       "      <td>1783.791667</td>\n",
       "      <td>0.007143</td>\n",
       "      <td>0.029031</td>\n",
       "      <td>12.241717</td>\n",
       "      <td>0.0</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12326</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5</td>\n",
       "      <td>465.750000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.021333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12327</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6</td>\n",
       "      <td>184.250000</td>\n",
       "      <td>0.083333</td>\n",
       "      <td>0.086667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>13</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12328</th>\n",
       "      <td>4</td>\n",
       "      <td>75.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>15</td>\n",
       "      <td>346.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.021053</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12329</th>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3</td>\n",
       "      <td>21.250000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.066667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12330 rows × 17 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Administrative  Administrative_Duration  Informational  \\\n",
       "0                   0                      0.0              0   \n",
       "1                   0                      0.0              0   \n",
       "2                   0                      0.0              0   \n",
       "3                   0                      0.0              0   \n",
       "4                   0                      0.0              0   \n",
       "...               ...                      ...            ...   \n",
       "12325               3                    145.0              0   \n",
       "12326               0                      0.0              0   \n",
       "12327               0                      0.0              0   \n",
       "12328               4                     75.0              0   \n",
       "12329               0                      0.0              0   \n",
       "\n",
       "       Informational_Duration  ProductRelated  ProductRelated_Duration  \\\n",
       "0                         0.0               1                 0.000000   \n",
       "1                         0.0               2                64.000000   \n",
       "2                         0.0               1                 0.000000   \n",
       "3                         0.0               2                 2.666667   \n",
       "4                         0.0              10               627.500000   \n",
       "...                       ...             ...                      ...   \n",
       "12325                     0.0              53              1783.791667   \n",
       "12326                     0.0               5               465.750000   \n",
       "12327                     0.0               6               184.250000   \n",
       "12328                     0.0              15               346.000000   \n",
       "12329                     0.0               3                21.250000   \n",
       "\n",
       "       BounceRates  ExitRates  PageValues  SpecialDay  Month  \\\n",
       "0         0.200000   0.200000    0.000000         0.0      2   \n",
       "1         0.000000   0.100000    0.000000         0.0      2   \n",
       "2         0.200000   0.200000    0.000000         0.0      2   \n",
       "3         0.050000   0.140000    0.000000         0.0      2   \n",
       "4         0.020000   0.050000    0.000000         0.0      2   \n",
       "...            ...        ...         ...         ...    ...   \n",
       "12325     0.007143   0.029031   12.241717         0.0     12   \n",
       "12326     0.000000   0.021333    0.000000         0.0     11   \n",
       "12327     0.083333   0.086667    0.000000         0.0     11   \n",
       "12328     0.000000   0.021053    0.000000         0.0     11   \n",
       "12329     0.000000   0.066667    0.000000         0.0     11   \n",
       "\n",
       "       OperatingSystems  Browser  Region  TrafficType  VisitorType  Weekend  \n",
       "0                     1        1       1            1            3        0  \n",
       "1                     2        2       1            2            3        0  \n",
       "2                     4        1       9            3            3        0  \n",
       "3                     3        2       2            4            3        0  \n",
       "4                     3        3       1            4            3        1  \n",
       "...                 ...      ...     ...          ...          ...      ...  \n",
       "12325                 4        6       1            1            3        1  \n",
       "12326                 3        2       1            8            3        1  \n",
       "12327                 3        2       1           13            3        1  \n",
       "12328                 2        2       3           11            3        0  \n",
       "12329                 3        2       1            2            2        1  \n",
       "\n",
       "[12330 rows x 17 columns]"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X = df.drop([\"Revenue\"], axis = 1)\n",
    "X\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        0\n",
       "1        0\n",
       "2        0\n",
       "3        0\n",
       "4        0\n",
       "        ..\n",
       "12325    0\n",
       "12326    0\n",
       "12327    0\n",
       "12328    0\n",
       "12329    0\n",
       "Name: Revenue, Length: 12330, dtype: int64"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y = df [\"Revenue\"]\n",
    "\n",
    "y"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[-0.69699296, -0.4571914 , -0.3964779 , ..., -0.76262903,\n",
       "         0.40102509, -0.55055169],\n",
       "       [-0.69699296, -0.4571914 , -0.3964779 , ..., -0.51418219,\n",
       "         0.40102509, -0.55055169],\n",
       "       [-0.69699296, -0.4571914 , -0.3964779 , ..., -0.26573535,\n",
       "         0.40102509, -0.55055169],\n",
       "       ...,\n",
       "       [-0.69699296, -0.4571914 , -0.3964779 , ...,  2.21873304,\n",
       "         0.40102509,  1.81635987],\n",
       "       [ 0.50722805, -0.03291592, -0.3964779 , ...,  1.72183936,\n",
       "         0.40102509, -0.55055169],\n",
       "       [-0.69699296, -0.4571914 , -0.3964779 , ..., -0.51418219,\n",
       "        -2.25167844,  1.81635987]])"
      ]
     },
     "execution_count": 87,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\"\"\" Normalize Data \"\"\"\n",
    "\n",
    "\n",
    "### 'Data Standardization' give data zero mean and unit variance, it is good practice, \n",
    "### especially for algorithms such as KNN which is based on distance of cases:\n",
    "\n",
    "from sklearn import preprocessing\n",
    "\n",
    "X = preprocessing.StandardScaler().fit(X).transform(X) #.astype(float))\n",
    "\n",
    "#XX = preprocessing.StandardScaler().fit(X).transform(X.astype(float))\n",
    "\n",
    "X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train set: (8631, 17) (8631,)\n",
      "Test set: (3699, 17) (3699,)\n"
     ]
    }
   ],
   "source": [
    "\"\"\" Train Test Split  \"\"\"\n",
    "\n",
    "###Train/Test Split for Classification method KNN \n",
    "\n",
    "###import train_test_split\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "# test_size %20 --- 4 categories \n",
    "X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.3) #, random_state= 1234)\n",
    "\n",
    "\n",
    "print ('Train set:', X_train.shape,  y_train.shape)\n",
    "\n",
    "print ('Test set:', X_test.shape,  y_test.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Classification"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.  K nearest neighbor (KNN) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train set Accuracy:  0.8854130459969876\n",
      "Test set Accuracy:  0.8799675587996756\n",
      "Training Accuracy : 0.8854130459969876\n",
      "Testing Accuracy : 0.8799675587996756\n"
     ]
    }
   ],
   "source": [
    "### import  K nearest Neighbors Classifier\n",
    "\n",
    "from sklearn.neighbors import KNeighborsClassifier\n",
    "\n",
    "###start the algorithm with k=4 for now:\n",
    "k = 17\n",
    "###Train Model and Predict \n",
    "neigh =  KNeighborsClassifier(n_neighbors = k ).fit(X_train,  y_train)\n",
    "\n",
    "\n",
    "###Predicting \n",
    "\n",
    "#Predict X_train\n",
    "y_pred = neigh.predict(X_train)\n",
    "\n",
    "#Predict X_test\n",
    "y_hat = neigh.predict(X_test)\n",
    "\n",
    "\n",
    "\n",
    "\"\"\" Accuracy evaluation \"\"\"\n",
    "\n",
    "\n",
    "\n",
    "\"\"\" In multilabel classification, \n",
    "    '__accuracy classification score__' is a function that computes subset accuracy. \n",
    "    This function is equal to the jaccard_similarity_score function. Essentially, it \n",
    "    calculates how closely the actual labels and predicted labels are matched in the test set.\n",
    "\"\"\"\n",
    "\n",
    "###import metrics from sklearn\n",
    "from sklearn import metrics\n",
    "\n",
    "\n",
    "print(\"Train set Accuracy: \", metrics.accuracy_score(y_train, y_pred))\n",
    "print(\"Test set Accuracy: \", metrics.accuracy_score(y_test, y_hat))\n",
    "\n",
    "\n",
    "\n",
    "# evaluating the model\n",
    "print(\"Training Accuracy :\", neigh.score(X_train, y_train))\n",
    "print(\"Testing Accuracy :\", neigh.score(X_test, y_test))\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "F1_score: 0.688168\n",
      "precision_score: 0.817958\n",
      "recall_score: 0.648194\n"
     ]
    }
   ],
   "source": [
    "###computing f1score\n",
    "\n",
    "from sklearn.metrics import accuracy_score, f1_score, precision_score, recall_score, classification_report, confusion_matrix\n",
    "\n",
    "#import scikitplot as skplt\n",
    "\n",
    "print(\"F1_score: %f\" % f1_score(y_test, y_hat, average=\"macro\"))\n",
    "print(\"precision_score: %f\" % precision_score(y_test, y_hat, average=\"macro\"))\n",
    "print(\"recall_score: %f\" % recall_score(y_test, y_hat, average=\"macro\"))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.89      0.99      0.94      7284\n",
      "           1       0.81      0.34      0.48      1347\n",
      "\n",
      "    accuracy                           0.89      8631\n",
      "   macro avg       0.85      0.66      0.71      8631\n",
      "weighted avg       0.88      0.89      0.87      8631\n",
      "\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.89      0.98      0.93      3138\n",
      "           1       0.75      0.32      0.44       561\n",
      "\n",
      "    accuracy                           0.88      3699\n",
      "   macro avg       0.82      0.65      0.69      3699\n",
      "weighted avg       0.87      0.88      0.86      3699\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import classification_report, confusion_matrix \n",
    "\n",
    "print(classification_report(y_train, y_pred))\n",
    "\n",
    "print(classification_report(y_test, y_hat)) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.metrics import plot_confusion_matrix\n",
    "plot_confusion_matrix(neigh, X_test, y_test, cmap=plt.cm.Blues)  \n",
    "plt.show() "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.83941606 0.86672074 0.86645039 0.87753447 0.87347932 0.8783455\n",
      " 0.8783455  0.88050825 0.87969722 0.87942687 0.87888619 0.8783455\n",
      " 0.87915653 0.87726413 0.87861584 0.87807516 0.87996756 0.8802379\n",
      " 0.88131928]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The best accuracy was with 0.8813192754798594 with k= 19\n"
     ]
    }
   ],
   "source": [
    "##We can calculate the accuracy of KNN for different Ks.\n",
    "\n",
    "Ks = 20\n",
    "mean_acc = np.zeros((Ks-1))\n",
    "std_acc = np.zeros((Ks-1))\n",
    "ConfustionMx = [];\n",
    "for n in range(1,Ks):\n",
    "    \n",
    "    #Train Model and Predict  \n",
    "    neigh = KNeighborsClassifier(n_neighbors = n).fit(X_train,y_train)\n",
    "    y_hat = neigh.predict(X_test)\n",
    "    mean_acc[n-1] = metrics.accuracy_score(y_test, y_hat)\n",
    "\n",
    "    \n",
    "    std_acc[n-1]=np.std(y_hat==y_test)/np.sqrt(y_hat.shape[0])\n",
    "\n",
    "print(mean_acc)\n",
    "\n",
    "\n",
    "#### Plot  model accuracy  for Different number of Neighbors \n",
    "\n",
    "plt.plot(range(1,Ks),mean_acc,'g')\n",
    "plt.fill_between(range(1,Ks),mean_acc - 1 * std_acc,mean_acc + 1 * std_acc, alpha=0.10)\n",
    "plt.legend(('Accuracy ', '+/- 3xstd'))\n",
    "plt.ylabel('Accuracy ')\n",
    "plt.xlabel('Number of Nabors (K)')\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "\n",
    "\n",
    "print( \"The best accuracy was with\", mean_acc.max(), \"with k=\", mean_acc.argmax()+1) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.  Logistic Regresion  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0 0 0 ... 0 0 0]\n",
      "[[0.98218598 0.01781402]\n",
      " [0.94166555 0.05833445]\n",
      " [0.78461571 0.21538429]\n",
      " ...\n",
      " [0.88647041 0.11352959]\n",
      " [0.83180939 0.16819061]\n",
      " [0.80656425 0.19343575]]\n"
     ]
    }
   ],
   "source": [
    "### using LogisticRegression from Scikit-learn package.\n",
    "\n",
    "\"\"\" LogisticRegression:\n",
    "        This function implements logistic regression \n",
    "        and can use different numerical optimizers to find parameters, \n",
    "        including ‘newton-cg’, ‘lbfgs’, ‘liblinear’, ‘sag’, ‘saga’ solvers\n",
    "\"\"\"\n",
    "\n",
    "\"\"\" The version of Logistic Regression in Scikit-learn, support regularization. \n",
    "    Regularization is a technique used to solve the overfitting problem in ML models. \n",
    "    C parameter indicates inverse of regularization strength which must be a positive \n",
    "    float. Smaller values specify stronger regularization.\n",
    "\"\"\"\n",
    "\n",
    "\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "\n",
    "LR = LogisticRegression(C=0.01, solver= 'liblinear').fit(X_train,y_train)\n",
    "\n",
    "\n",
    "### predict using our test set\n",
    "\n",
    "yhat = LR.predict(X_test)\n",
    "print(yhat)\n",
    "\n",
    "\n",
    "\"\"\" predict_proba: returns estimates for all classes, \n",
    "    ordered by the label of classes. \n",
    "    So, the first column is the probability of class 1, P(Y=1|X),\n",
    "    and second column is probability of class 0, P(Y=0|X):\n",
    "\"\"\"\n",
    "\n",
    "yhat_prob = LR.predict_proba(X_test)\n",
    "print(yhat_prob)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import jaccard_score, f1_score, log_loss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LR's Accuracy by metrics:  0.875506893755069\n",
      "LR's Accuracy by jaccard:  0.2926267281105991\n",
      "LR's Accuracy by LogLoss:  0.30877158360366236\n"
     ]
    }
   ],
   "source": [
    "\n",
    "\n",
    "\"\"\" Evaluation \"\"\"\n",
    "\n",
    "\n",
    "### Method  1\n",
    "\n",
    "from sklearn import metrics\n",
    "\n",
    "\n",
    "#metrics.accuracy_score(y_train, LR.predict(X_train)\n",
    "\n",
    "print(\"LR's Accuracy by metrics: \", metrics.accuracy_score(y_test, yhat))\n",
    "\n",
    "\n",
    "\n",
    "### Method 2\n",
    "\"\"\" jaccard index: \n",
    "            Lets try jaccard index for accuracy evaluation. \n",
    "            we can define jaccard as the size of the intersection \n",
    "            divided by the size of the union of two label sets. \n",
    "            If the entire set of predicted labels for a sample \n",
    "            strictly match with the true set of labels, \n",
    "            then the subset accuracy is 1.0; otherwise it is 0.0.\n",
    "\"\"\"\n",
    "\n",
    "\n",
    "### Valid labels for pos_label are: array(['COLLECTION', 'PAIDOFF']\n",
    "from sklearn.metrics import jaccard_score\n",
    "print(\"LR's Accuracy by jaccard: \", jaccard_score(y_test, yhat))\n",
    "\n",
    "\n",
    "\n",
    "### Method 3\n",
    "\n",
    "\"\"\" log loss:\n",
    "    Now, lets try log loss for evaluation. \n",
    "    In logistic regression, the output can \n",
    "    be the probability of customer churn is yes (or equals to 1). \n",
    "    This probability is a value between 0 and 1. \n",
    "    Log loss( Logarithmic loss) measures the performance of a classifier \n",
    "    where the predicted output is a probability value between 0 and 1.\n",
    "\"\"\"\n",
    "\n",
    "from sklearn.metrics import log_loss\n",
    "print(\"LR's Accuracy by LogLoss: \", log_loss(y_test, yhat_prob))\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LR_prac's Accuracy by metrics:  0.8763179237631792\n",
      "LR_prac's Accuracy by jaccard:  0.28738317757009346\n",
      "LR_prac's Accuracy by LogLoss:  0.30877158360366236\n"
     ]
    }
   ],
   "source": [
    "\n",
    "\n",
    "\"\"\" Practice:\n",
    "\n",
    "    Try to build Logistic Regression model again for the same dataset, \n",
    "    but this time, use different __solver__ and __regularization__ values? \n",
    "    What is new __logLoss__ value?\n",
    "\n",
    "\"\"\" \n",
    "\n",
    "\n",
    "\n",
    "LR_prac = LogisticRegression(C=0.01, solver= 'sag').fit(X_train,y_train)\n",
    "\n",
    "\n",
    "### predict using our test set\n",
    "\n",
    "yhat_prac = LR_prac.predict(X_test)\n",
    "yhat_prac\n",
    "\n",
    "\n",
    "\"\"\" predict_proba: returns estimates for all classes, \n",
    "    ordered by the label of classes. \n",
    "    So, the first column is the probability of class 1, P(Y=1|X),\n",
    "    and second column is probability of class 0, P(Y=0|X):\n",
    "\"\"\"\n",
    "\n",
    "yhat_prob_prac = LR.predict_proba(X_test)\n",
    "yhat_prob_prac\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\"\"\" Evaluation \"\"\"\n",
    "\n",
    "\n",
    "### Method  1\n",
    "\n",
    "\n",
    "#metrics.accuracy_score(y_train, LR.predict(X_train)\n",
    "\n",
    "print(\"LR_prac's Accuracy by metrics: \", metrics.accuracy_score(y_test, yhat_prac))\n",
    "\n",
    "\n",
    "\n",
    "### Method 2\n",
    "\n",
    "\n",
    "print(\"LR_prac's Accuracy by jaccard: \", jaccard_score(y_test, yhat_prac))\n",
    "\n",
    "\n",
    "\n",
    "### Method 3\n",
    "\n",
    "\n",
    "from sklearn.metrics import log_loss\n",
    "print(\"LR_prac's Accuracy by LogLoss: \", log_loss(y_test, yhat_prob_prac))\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
